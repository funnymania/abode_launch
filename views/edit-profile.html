<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Edit Profile</title>
		<meta name="description" content="Login Test">
		<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
		<link rel="icon" href="https://funnymania.lol/favicon.ico">
		<link rel="stylesheet" href="global.css">
		<style>
			html {
				height: 100%;
			}
			#splash {
				width: 100%;
				height: 100%;
			}
			body {
				margin: 0px;	
			}
		</style>
	</head>
	<body>
		<div>
			<img id="pfp">
			<span>Name: </span><input id="name-display">
			<span>id-id:</span> <div id="id-display"></div>
		</div>
		<div>
			<button onclick="updateUser()">Update this bitch</button>
		</div>
		<script>
			let u = document.getElementById('name-display');
			let pfp = document.getElementById('pfp');
			let id = document.getElementById('id-display');

			let dynamicId = 'bcb7787f-8fe3-4435-8daa-a5e4002bb9fb';

			getIdentityById();

			function getIdentityById() {
				// Form post request
				let req = {
					credentials: 'include',
					method: 'GET',
				}

				// request, display response
				fetch('/v1/identity/' + dynamicId, req)
					.then(res => res.json())
					.then(res => {
						if (res.error === undefined) {
							u.value = res.identity.name;
							id.innerHTML = res.identity.id;
							pfp.src = res.identity.pfp;
						} else {
							console.log('Could not load page');
						}
					});
			}

	function updateUser() {
				let body = {
					identity: {
						name: u.value,
					}
				}

				// Form post request
				let req = {
					credentials: 'include',
					method: 'PUT',
					body: JSON.stringify(body)
				}

				// request, display response
				fetch('/v1/identity/' + dynamicId, req)
					.then(res => res.json())
					.then(res => {
						if (res.error === undefined) {
							u.value = res.identity.name;
							id.innerHTML = res.identity.id;
							pfp.src = res.identity.pfp;
						} else {
							console.log('Could not load page');
						}
					});
		
	}
		</script>
	</body>
</html>
